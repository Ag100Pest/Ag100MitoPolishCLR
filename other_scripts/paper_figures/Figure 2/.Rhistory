DrawArc(x = repeat1+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
repeat2<-cbind(seq(from = 3379, to = 3577, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat2+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
###LABS###
segments(0, 45, 6081, 45, col = "black", lwd=6)
text(labels="L. agilis", x=150, y=37.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="L. agilis", x=150, y=27.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="(Pacbio)", x=150, y=35.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="(Nanopore)", x=150, y=25.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NOVOPlasty", x=150, y=17.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NC_021766.1", x=150, y=7.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="a", x=20, y=47.5, cex=10, font=2, family="Arial", pos = 4)
start = 15000
offset = 15000-14032
labels1=seq(from = start/1000, to = 18, by = 1)
x1=seq(from = 0, to = 4062, by = 1000)
x2=seq(from = start-800, to = start + 5062-1000, by = 200)
for(i in 1:length(x1)) {
text(labels=labels1[i], x=x1[i]+offset, y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x1[i]+offset, 45, x1[i]+offset, 45.5, col = "black", lwd=6)
}
for(i in x2) {
segments(i-start+offset, 45, i-start+offset, 45.25, col = "black", lwd=6)
}
labels2=seq(from = 0, to = 2,by = 1)
x3=seq(from = 5063, to = 6081, by = 1000)
x4=seq(from = 5063, to = 6081, by = 200)
for(i in 1:length(x3)) {
text(labels=labels2[i], x=x3[i], y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x3[i], 45, x3[i], 45.5, col = "black", lwd=6)
}
for(i in x4) {
segments(i, 45, i, 45.25, col = "black", lwd=6)
}
dev.off()
png("Fig. 2a.png", width = 4500, height = 5000)
xlim <- c(0 , 6100)
ylim <- c(0, 60)
plot(0, type = "n", xlim = xlim, ylim = ylim,
main = "", axes=FALSE, xlab = "", ylab = "")
lwd <- 150
arr.width <- 4.5
arr.length <- 1.4
##loading data
rLacAgi1_pacbio<-read.csv("rLacAgi1_pacbio.txt", na.strings = c(".", "N"), sep="\t", header = FALSE)
names(rLacAgi1_pacbio) <- c("dataset", "start","end","type","name","strand")
vcolor_easy = c("#d5ba4d", "#4DBBD5FF", "#DC0000FF", "#00A087FF")[rLacAgi1_pacbio$type]
varr.length = c(arr.length, arr.length, arr.length, arr.length)[rLacAgi1_pacbio$type]
varr.type = c("triangle", "triangle", "triangle","triangle")[rLacAgi1_pacbio$type]
vx0 <- rLacAgi1_pacbio$start
vx1 <- rLacAgi1_pacbio$end
rLacAgi1_refseq<-read.csv("rLacAgi1_refseq.txt", na.strings = c(".", "N"), sep="\t", header = FALSE)
names(rLacAgi1_refseq) <- c("dataset", "start","end","type","name","strand")
rcolor_easy = c("black","#d5ba4d", "#4DBBD5FF", "#DC0000FF", "#00A087FF")[rLacAgi1_refseq$type]
rarr.length = c(0, arr.length, arr.length, arr.length, arr.length)[rLacAgi1_refseq$type]
rarr.type = c("NA","triangle","triangle", "triangle", "triangle")[rLacAgi1_refseq$type]
rx0 <- rLacAgi1_refseq$start
rx1 <- rLacAgi1_refseq$end
###RECT###
#1
vy0 <- rep(30,13)
vy1 <- rep(30,13)
ry0 <- rep(40,13)
ry1 <- rep(40,13)
rect(vx0[1], vy0[1], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
#2
vy0 <- rep(20,13)
vy1 <- rep(20,13)
ry0 <- rep(30,13)
ry1 <- rep(30,13)
rect(vx0[1], vy0[1], rx1[5], ry1[5], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
polygon(c(rx1[5],rx1[2]-207,vx1[5],vx1[9]), c(vy1[1],vy1[1],ry1[1],ry1[1]), density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA)
rect(vx0[10], vy0[10], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
#3
vy0 <- rep(10,13)
vy1 <- rep(10,13)
ry0 <- rep(20,13)
ry1 <- rep(20,13)
rect(vx0[1], vy0[1], rx1[5], ry1[5], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
rect(vx0[10], vy0[10], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
####REF####
ry0 <- rep(10,13)
ry1 <- rep(10,13)
for(i in 1:length(rx0)) {
if(rLacAgi1_refseq$strand[i] == "+"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx0[i], ry0[i], rx1[i]-70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx0[i], ry0[i], rx1[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else if (rLacAgi1_refseq$strand[i] == "-"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx1[i], ry0[i], rx0[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else{
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=10, lty=2)
}
}
y<-read.csv("rLacAgi1_RefSeq.snp", sep="\t", header = FALSE)
for(i in 1:length(y[,1])) {
segments(y[i,1], 9.25, y[i,1], 10.75, col = colorize(y[i,3]), lwd=2.5)
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####NOVOPlasty####
ry0 <- rep(20,13)
ry1 <- rep(20,13)
for(i in 1:length(rx0)) {
if(rLacAgi1_refseq$strand[i] == "+"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx0[i], ry0[i], rx1[i]-70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx0[i], ry0[i], rx1[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else if (rLacAgi1_refseq$strand[i] == "-"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx1[i], ry0[i], rx0[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else{
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=10, lty=2)
}
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+10-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####VGP_nanopore####
vy0 <- rep(30,13)
vy1 <- rep(30,13)
for(i in 1:length(vx0)) {
if(rLacAgi1_pacbio$strand[i] == "+"){
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx0[i], vy0[i], vx1[i]-70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx0[i], vy0[i], vx1[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}else{
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx1[i], vy0[i], vx0[i]+70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx1[i], vy0[i], vx0[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}
}
y<-read.csv("rLacAgi1_ont.cov", sep="\t", header = FALSE)
y<-linMap(y)
for(i in 1:tail(rx1, n=1)) {
segments(i, 31.5, i+1, 31.5+y[i,], col = "gray")
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+20-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
repeat2<-cbind(seq(from = 3379, to = 3577, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat2+50, y = rep(11+20-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####VGP_pacbio####
vy0 <- rep(40,13)
vy1 <- rep(40,13)
for(i in 1:length(vx0)) {
if(rLacAgi1_pacbio$strand[i] == "+"){
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx0[i], vy0[i], vx1[i]-70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx0[i], vy0[i], vx1[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}else{
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx1[i], vy0[i], vx0[i]+70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx1[i], vy0[i], vx0[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}
}
y<-read.csv("rLacAgi1_pacbio.cov", sep="\t", header = FALSE)
y<-linMap(y)
for(i in 1:tail(rx1, n=1)) {
segments(i, 41.5, i+1, 41.5+y[i,], col = "gray")
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
repeat2<-cbind(seq(from = 3379, to = 3577, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat2+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
###LABS###
segments(0, 45, 6081, 45, col = "black", lwd=6)
text(labels="L. agilis", x=150, y=37.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="L. agilis", x=150, y=27.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="(Pacbio)", x=150, y=35.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="(Nanopore)", x=150, y=25.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NOVOPlasty", x=150, y=17.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NC_021766.1", x=150, y=7.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="a", x=20, y=47.5, cex=10, font=2, family="Arial", pos = 4)
start = 15000
offset = 15000-14032
labels1=seq(from = start/1000, to = 18, by = 1)
x1=seq(from = 0, to = 4062, by = 1000)
x2=seq(from = start-800, to = start + 5062-1000, by = 200)
for(i in 1:length(x1)) {
text(labels=labels1[i], x=x1[i]+offset, y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x1[i]+offset, 45, x1[i]+offset, 45.5, col = "black", lwd=6)
}
for(i in x2) {
segments(i-start+offset, 45, i-start+offset, 45.25, col = "black", lwd=6)
}
labels2=seq(from = 0, to = 2,by = 1)
x3=seq(from = 5063, to = 6081, by = 1000)
x4=seq(from = 5063, to = 6081, by = 200)
for(i in 1:length(x3)) {
text(labels=labels2[i], x=x3[i], y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x3[i], 45, x3[i], 45.5, col = "black", lwd=6)
}
for(i in x4) {
segments(i, 45, i, 45.25, col = "black", lwd=6)
}
dev.off()
png("Fig. 2a.png", width = 4500, height = 5000)
xlim <- c(0 , 6100)
ylim <- c(0, 60)
plot(0, type = "n", xlim = xlim, ylim = ylim,
main = "", axes=FALSE, xlab = "", ylab = "")
lwd <- 150
arr.width <- 4.5
arr.length <- 1.4
##loading data
rLacAgi1_pacbio<-read.csv("rLacAgi1_pacbio.txt", na.strings = c(".", "N"), sep="\t", header = FALSE)
names(rLacAgi1_pacbio) <- c("dataset", "start","end","type","name","strand")
vcolor_easy = c("#d5ba4d", "#4DBBD5FF", "#DC0000FF", "#00A087FF")[rLacAgi1_pacbio$type]
varr.length = c(arr.length, arr.length, arr.length, arr.length)[rLacAgi1_pacbio$type]
varr.type = c("triangle", "triangle", "triangle","triangle")[rLacAgi1_pacbio$type]
vx0 <- rLacAgi1_pacbio$start
vx1 <- rLacAgi1_pacbio$end
rLacAgi1_refseq<-read.csv("rLacAgi1_refseq.txt", na.strings = c(".", "N"), sep="\t", header = FALSE)
names(rLacAgi1_refseq) <- c("dataset", "start","end","type","name","strand")
rcolor_easy = c("black","#d5ba4d", "#4DBBD5FF", "#DC0000FF", "#00A087FF")[rLacAgi1_refseq$type]
rarr.length = c(0, arr.length, arr.length, arr.length, arr.length)[rLacAgi1_refseq$type]
rarr.type = c("NA","triangle","triangle", "triangle", "triangle")[rLacAgi1_refseq$type]
rx0 <- rLacAgi1_refseq$start
rx1 <- rLacAgi1_refseq$end
###RECT###
#1
vy0 <- rep(30,13)
vy1 <- rep(30,13)
ry0 <- rep(40,13)
ry1 <- rep(40,13)
rect(vx0[1], vy0[1], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
#2
vy0 <- rep(20,13)
vy1 <- rep(20,13)
ry0 <- rep(30,13)
ry1 <- rep(30,13)
rect(vx0[1], vy0[1], rx1[5], ry1[5], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
polygon(c(rx1[5],rx1[2]-207,vx1[5],vx1[9]), c(vy1[1],vy1[1],ry1[1],ry1[1]), density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA)
rect(vx0[10], vy0[10], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
#3
vy0 <- rep(10,13)
vy1 <- rep(10,13)
ry0 <- rep(20,13)
ry1 <- rep(20,13)
rect(vx0[1], vy0[1], rx1[5], ry1[5], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
rect(vx0[10], vy0[10], rx1[8], ry1[8], density = NULL, angle = 45,
col = rgb(255, 165, 0, max = 255, alpha = 50), border = NA, lty = par("lty"), lwd = par("lwd"))
####REF####
ry0 <- rep(10,13)
ry1 <- rep(10,13)
for(i in 1:length(rx0)) {
if(rLacAgi1_refseq$strand[i] == "+"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx0[i], ry0[i], rx1[i]-70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx0[i], ry0[i], rx1[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else if (rLacAgi1_refseq$strand[i] == "-"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx1[i], ry0[i], rx0[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else{
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=10, lty=2)
}
}
y<-read.csv("rLacAgi1_RefSeq.snp", sep="\t", header = FALSE)
for(i in 1:length(y[,1])) {
segments(y[i,1], 9.25, y[i,1], 10.75, col = colorize(y[i,3]), lwd=2.5)
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####NOVOPlasty####
ry0 <- rep(20,13)
ry1 <- rep(20,13)
for(i in 1:length(rx0)) {
if(rLacAgi1_refseq$strand[i] == "+"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx0[i], ry0[i], rx1[i]-70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx0[i], ry0[i], rx1[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else if (rLacAgi1_refseq$strand[i] == "-"){
if(!(rLacAgi1_refseq$type[i] == "tRNA")){
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(rx1[i], ry0[i], rx0[i], ry1[i], arr.length = rarr.length[i], arr.width = arr.width, code = 2,
arr.col = rcolor_easy[i], lcol = rcolor_easy[i], segment = FALSE, arr.type = rarr.type[i], arr.adj = 1)
}else{
segments(rx1[i], ry0[i], rx0[i]+70, ry1[i], col = rcolor_easy[i], lend=1, lwd=10, lty=2)
}
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+10-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####VGP_nanopore####
vy0 <- rep(30,13)
vy1 <- rep(30,13)
for(i in 1:length(vx0)) {
if(rLacAgi1_pacbio$strand[i] == "+"){
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx0[i], vy0[i], vx1[i]-70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx0[i], vy0[i], vx1[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}else{
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx1[i], vy0[i], vx0[i]+70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx1[i], vy0[i], vx0[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}
}
y<-read.csv("rLacAgi1_ont.cov", sep="\t", header = FALSE)
y<-linMap(y)
for(i in 1:tail(rx1, n=1)) {
segments(i, 31.5, i+1, 31.5+y[i,], col = "gray")
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+20-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
repeat2<-cbind(seq(from = 3379, to = 3577, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat2+50, y = rep(11+20-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
####VGP_pacbio####
vy0 <- rep(40,13)
vy1 <- rep(40,13)
for(i in 1:length(vx0)) {
if(rLacAgi1_pacbio$strand[i] == "+"){
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx0[i], vy0[i], vx1[i]-70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx0[i], vy0[i], vx1[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}else{
if(!(rLacAgi1_pacbio$type[i] == "tRNA")){
segments(vx1[i], vy0[i], vx0[i]+70, vy1[i], col = vcolor_easy[i], lend=1, lwd=lwd)
}
Arrows(vx1[i], vy0[i], vx0[i], vy1[i], arr.length = varr.length[i], arr.width = arr.width, code = 2,
arr.col = vcolor_easy[i], lcol = vcolor_easy[i], segment = FALSE, arr.type = varr.type[i], arr.adj = 1)
}
}
y<-read.csv("rLacAgi1_pacbio.cov", sep="\t", header = FALSE)
y<-linMap(y)
for(i in 1:tail(rx1, n=1)) {
segments(i, 41.5, i+1, 41.5+y[i,], col = "gray")
}
repeat1<-cbind(seq(from = 1376, to = 1376+199, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat1+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
repeat2<-cbind(seq(from = 3379, to = 3577, by = 1))
n=100
color = ""
for(i in 1:nrow(repeat1)) {
color[i]<-randomColor(hue="blue")
}
DrawArc(x = repeat2+50, y = rep(11+30-2,length(repeat1)), rx = rep(40,length(repeat1)), ry = -rep(4,length(repeat1)),
theta.1 = 0.145, theta.2 = 3, nv = 1000,
col = color, lty = par("lty"), lwd = par("lwd"),
plot = TRUE)
###LABS###
segments(0, 45, 6081, 45, col = "black", lwd=6)
text(labels="L. agilis", x=150, y=37.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="L. agilis", x=150, y=27.5, cex=10, font=3, family="Arial", pos = 4)
text(labels="(Pacbio)", x=150, y=35.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="(Nanopore)", x=150, y=25.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NOVOPlasty", x=150, y=17.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="NC_021766.1", x=150, y=7.5, cex=10, font=1, family="Arial", pos = 4)
text(labels="a", x=20, y=47.5, cex=10, font=2, family="Arial", pos = 4)
start = 15000
offset = 15000-14032
labels1=seq(from = start/1000, to = 18, by = 1)
x1=seq(from = 0, to = 4062, by = 1000)
x2=seq(from = start-800, to = start + 5062-1000, by = 200)
for(i in 1:length(x1)) {
text(labels=labels1[i], x=x1[i]+offset, y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x1[i]+offset, 45, x1[i]+offset, 45.5, col = "black", lwd=6)
}
for(i in x2) {
segments(i-start+offset, 45, i-start+offset, 45.25, col = "black", lwd=6)
}
labels2=seq(from = 0, to = 2,by = 1)
x3=seq(from = 5063, to = 6081, by = 1000)
x4=seq(from = 5063, to = 6081, by = 200)
for(i in 1:length(x3)) {
text(labels=labels2[i], x=x3[i], y=47, cex=10, font=1, family="Arial", pos = 1)
segments(x3[i], 45, x3[i], 45.5, col = "black", lwd=6)
}
for(i in x4) {
segments(i, 45, i, 45.25, col = "black", lwd=6)
}
dev.off()
