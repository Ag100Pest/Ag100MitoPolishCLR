%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.5
%%CreationDate: Fri Apr  3 10:53:18 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UAGGCGGAGGUCGGUUGGUUUAGACGCUUAGCUGUUAACUAAAUGUUUGUGGGAUCAAGGCCCGCUCGCCUAG\
) def
/coor [
[112.707 227.635]
[112.070 212.648]
[111.434 197.662]
[110.797 182.675]
[110.160 167.689]
[109.524 152.702]
[108.887 137.716]
[90.234 135.787]
[75.475 125.586]
[67.809 110.267]
[52.863 111.539]
[37.917 112.811]
[31.466 126.750]
[18.901 135.582]
[3.601 136.932]
[-10.317 130.438]
[-19.110 117.845]
[-20.412 102.541]
[-13.874 88.644]
[-1.254 79.890]
[14.054 78.636]
[27.931 85.217]
[36.645 97.865]
[51.591 96.593]
[66.537 95.321]
[70.108 84.247]
[77.224 75.042]
[87.040 68.796]
[84.505 54.011]
[81.970 39.227]
[79.435 24.443]
[65.839 16.717]
[60.439 2.042]
[65.784 -12.654]
[79.350 -20.431]
[94.732 -17.618]
[104.668 -5.542]
[104.465 10.094]
[94.219 21.908]
[96.754 36.692]
[99.289 51.476]
[101.824 66.261]
[110.717 67.210]
[119.228 70.509]
[126.735 76.019]
[132.664 83.437]
[136.531 92.312]
[137.984 102.070]
[136.826 112.054]
[151.705 113.959]
[166.583 115.864]
[181.462 117.769]
[196.340 119.675]
[207.708 108.937]
[223.322 108.071]
[235.809 117.485]
[239.272 132.734]
[232.078 146.618]
[217.622 152.582]
[202.731 147.809]
[194.435 134.553]
[179.556 132.648]
[164.678 130.743]
[149.799 128.837]
[134.921 126.932]
[123.874 137.079]
[124.510 152.066]
[125.147 167.052]
[125.784 182.039]
[126.420 197.025]
[127.057 212.011]
[127.693 226.998]
[130.700 246.145]
] def
/pairs [
[1 72]
[2 71]
[3 70]
[4 69]
[5 68]
[6 67]
[7 66]
[10 25]
[11 24]
[12 23]
[28 42]
[29 41]
[30 40]
[31 39]
[49 65]
[50 64]
[51 63]
[52 62]
[53 61]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
